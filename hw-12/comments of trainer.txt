В задании 3 можно сделать необходимые вычисления в одной группировке с помощью метода agg:
ratings.groupby('userId').agg({'timestamp': ['min', 'max', 'count']})
Затем останется только отфильтровать по числу оценок и посчитать среднюю разницу min и max.